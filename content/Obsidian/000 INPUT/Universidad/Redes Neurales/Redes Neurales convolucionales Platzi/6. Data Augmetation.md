
## Data Augmentation y Regularización Avanzada

### Data Augmentation
El **Data Augmentation** (aumento de datos) es una técnica fundamental para mejorar el rendimiento y la capacidad de generalización de las ConvNets, especialmente cuando el conjunto de datos disponible es limitado. Consiste en aumentar artificialmente el tamaño del dataset mediante la generación de nuevas muestras a partir de modificaciones a las muestras originales.

#### Transformaciones Geométricas
Estas técnicas implican la modificación de la geometría de las imágenes de entrada sin cambiar su naturaleza, lo que ayuda a la red a aprender a reconocer patrones bajo diferentes transformaciones:

- **Rotación**: Las imágenes se rotan aleatoriamente en un rango específico (por ejemplo, entre -15° y 15°). Esto mejora la invariancia a la orientación.
- **Traslación**: Se desplazan las imágenes horizontal o verticalmente para simular diferentes posiciones de los objetos dentro de una imagen.
- **Escalado (Scaling)**: Cambiar el tamaño de la imagen (agrandarla o reducirla) permite que la red aprenda a reconocer objetos independientemente de su tamaño relativo.
- **Flipping**: Invertir las imágenes horizontalmente (espejado), lo cual es útil especialmente en imágenes simétricas como paisajes o rostros.

#### Ajustes de Color
El ajuste de color ayuda a la red a ser menos sensible a las variaciones en el color y la iluminación, lo que es particularmente importante para tareas de visión en ambientes poco controlados:

- **Brillo, Saturación, y Contraste**: Ajustar estos parámetros ayuda a aumentar la variabilidad de las imágenes, haciendo a la red más robusta frente a cambios de iluminación.
- **Ajuste de Hue**: Modificar los tonos de los colores (hue) puede ayudar a la red a aprender a ignorar cambios accidentales en las condiciones de color.

#### Adición de Ruido Aleatorio
- **Ruido Gaussiano**: Se añade ruido gaussiano a las imágenes para simular la presencia de ruido en las condiciones reales (como el ruido generado por sensores de cámaras).
- **Occlusion**: Colocar bloques negros o de otro color sobre la imagen de entrada para enseñar al modelo a lidiar con objetos parcialmente ocultos.

#### Beneficios del Data Augmentation
- **Mejora la Generalización**: Aumenta la robustez de la red frente a variaciones que podría encontrar en datos del mundo real.
- **Reduce el Sobreajuste (Overfitting)**: Al exponer la red a múltiples versiones modificadas de los datos, el modelo se vuelve menos propenso a aprender características específicas de las imágenes de entrenamiento, favoreciendo el aprendizaje de patrones generales.

### Regularización Avanzada
Además del Data Augmentation, se utilizan diversas técnicas avanzadas de regularización para evitar el sobreajuste y mejorar la capacidad del modelo de generalizar sobre nuevos datos. Ya vimos algunas en [[8.2 Dropout]]



## Referencias
### Notas relacionadas
- **Nota:**[[8.2 Dropout]]
	- **Relacion-Reflexion:** Ademas de utilizar Data augmetation debemos tener en cuenta diversas tecnicas de regularizacion para evitar el sobreajuste y la capacidad de nuestro modelo. Estas las vimos en esta nota como L1,L2, bach normalizado y dropout




# Data Augmetation en keras

### Explicación General sobre Data Augmentation con Keras
**Data Augmentation** es una técnica común en visión por computadora que se utiliza para aumentar el tamaño del conjunto de datos generando variantes de las imágenes originales mediante transformaciones. En Keras, se puede lograr fácilmente usando la clase `ImageDataGenerator`.

Voy a describir cómo generalmente se implementa un pipeline de Data Augmentation:

1. **Importación de bibliotecas necesarias**
   ```python
   from tensorflow.keras.preprocessing.image import ImageDataGenerator
   ```
   - `ImageDataGenerator` es la clase principal en Keras para realizar Data Augmentation.

2. **Creación de un objeto de Data Augmentation**
   ```python
   datagen = ImageDataGenerator(
       rotation_range=40,
       width_shift_range=0.2,
       height_shift_range=0.2,
       shear_range=0.2,
       zoom_range=0.2,
       horizontal_flip=True,
       fill_mode='nearest'
   )
   ```
   - **`rotation_range`**: Gira la imagen en un rango de 0 a 40 grados.
   - **`width_shift_range` y `height_shift_range`**: Desplazamiento horizontal y vertical (en porcentaje de la imagen).
   - **`shear_range`**: Transformación de corte para cambiar la geometría de la imagen.
   - **`zoom_range`**: Zoom dentro y fuera de la imagen.
   - **`horizontal_flip`**: Voltea la imagen horizontalmente.
   - **`fill_mode`**: Cómo rellenar los píxeles vacíos después de las transformaciones.

3. **Uso de Data Augmentation en el conjunto de datos**
   ```python
   (x_train, y_train), (x_test, y_test) = cifar10.load_data()
   x_train = x_train / 255.0  # Normalización de las imágenes

   datagen.fit(x_train)  # Ajustar el generador de imágenes con los datos de entrenamiento
   ```
   - Se carga el dataset (`CIFAR-10` en este caso).
   - Luego, se normalizan las imágenes y se ajustan al generador.

4. **Entrenamiento del modelo utilizando el generador de datos**
   ```python
   model = tf.keras.models.Sequential([...])  # Definición del modelo, similar a los ejemplos anteriores

   model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])

   model.fit(datagen.flow(x_train, y_train, batch_size=32), 
             epochs=50,
             validation_data=(x_test, y_test))
   ```
   - **`datagen.flow(x_train, y_train, batch_size=32)`**: Este método genera los lotes aumentados de manera aleatoria durante el entrenamiento. Cada lote contiene imágenes diferentes, lo que ayuda al modelo a generalizar mejor.
   - **`epochs=50`**: Se entrena el modelo durante 50 épocas para beneficiarse de la variabilidad de los datos.

5. **Visualización de las Imágenes Aumentadas (Opcional)**
   ```python
   import matplotlib.pyplot as plt

   for x_batch, y_batch in datagen.flow(x_train, y_train, batch_size=9):
       for i in range(0, 9):
           plt.subplot(330 + 1 + i)
           plt.imshow(x_batch[i])
       plt.show()
       break
   ```
   - Esto visualiza algunas imágenes transformadas para verificar cómo se aplica el Data Augmentation.

