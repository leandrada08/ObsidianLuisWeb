
## [[Sistemas de numeracion]]

## Aritmética de punto flotante:
La aritmética de punto flotante es un método más flexible y versátil para representar números en sistemas digitales.
- Los números se representan utilizando un formato compuesto por una mantisa, un exponente y un signo.
	- La mantisa representa la parte fraccionaria del número, mientras que el exponente determina la posición del punto decimal y la escala del número
- El formato de punto flotante permite representar números con una amplia gama de magnitudes y precisión variable.  
- Las operaciones se realizan teniendo en cuenta tanto la mantisa como el exponente.
- Esto permite realizar operaciones con números de diferentes magnitudes y mantener una precisión adecuada. 
- Las operaciones de punto flotante son más complejas y requieren algoritmos especializados para garantizar la precisión y el rango correctos.

### Formato
La representación de punto flotante es conveniente para números con gran rango dinámico.
- Basado en el número de bits, hay dos representaciones en el estándar IEEE 754: **32 bits en simple precisión y 64 bits en doble precisión**.
- Esta norma se utiliza casi exclusivamente en plataformas informáticas y diseños de hardware que soportan la aritmética de punto flotante.
Un número de punto flotante normalizado x se almacena en tres partes: El signo s, exponente e y mantisa m $$x=(-1)^s*1*m*2^{e-b}$$
- s : Signo
- m : Magnitud
- e : exponente
- b : vale 127
![[Pasted image 20231108175525.png|400]]
#### ejemplo
![[Pasted image 20231108181613.png]]
### Valores espeiales del exponente e
1. e>valor maximo:
	- Se utiliza $\infty$
2. e< valor minimo:
	- Se utiliza -$\infty$
3. e=0:
	- Se utiliza unicamente la matiza
	- Se trata como desnormalizados y el bit implicito de la matiza vale 0


### Adicion aritmetica
1. Verificar y alinear los exponentes:
   - Comparar los exponentes de los dos números.
   - Si son diferentes, ajustar el número con el exponente más pequeño para que coincida con el exponente del número más grande.
   - Si el número con el exponente más pequeño tiene una mantisa no normalizada, normalizarla para que tenga el bit implícito de 1.
2. Sumar las mantisas:
   - Sumar las mantisas de los dos números después de haber alineado los exponentes.
   - Asegurarse de llevar correctamente cualquier acarreo generado durante la suma.
3. Verificar y corregir el resultado:
   - Si el resultado de la suma de las mantisas tiene más bits de los que se pueden representar en el formato de punto flotante, realizar el redondeo o truncamiento según sea necesario para ajustarse al número de bits disponibles.
4. Normalizar el resultado:
   - Si el resultado de la suma es mayor que el rango representable, normalizar el resultado dividiendo la mantisa por 2 y ajustando el exponente en consecuencia.
5. Verificar y corregir el signo:
   - Si los signos de los dos números son diferentes, restar el número con el signo negativo del número con el signo positivo para obtener el resultado correcto con el signo adecuado.
6. Verificar y corregir el exponente:
   - Si se produce un desbordamiento o subdesbordamiento durante la adición, ajustar el exponente en consecuencia y tomar las acciones necesarias para mantener la precisión del resultado.

### Multiplicacion aritmetica
Paso 1: Verificar y sumar los exponentes:
- Suma los exponentes de los dos números y resta el bias(el b) correspondiente al formato de punto flotante utilizado.
- Asegúrate de ajustar el exponente si es necesario y ten en cuenta las reglas para manejar desbordamientos y subdesbordamientos.
Paso 2: Multiplicar las mantisas:
- Multiplica las mantisas de los dos números y ajusta la posición del punto decimal para reflejar la multiplicación.
Paso 3: Normalizar el resultado:
- Si el resultado de la multiplicación no está normalizado, desplaza el punto decimal y ajusta el exponente en consecuencia.
- Asegúrate de que el resultado tenga el bit implícito de 1 en la mantisa.
Paso 4: Verificar y corregir el signo:
- Si los signos de los dos números son diferentes, el resultado será negativo y se debe aplicar el signo adecuado.
Paso 5: Verificar y corregir el exponente:
- Ajusta el exponente del resultado según sea necesario para asegurar que esté en el rango válido y cumplir con las convenciones del formato de punto flotante.
Paso 6: Redondear o truncar el resultado:
- Si es necesario, redondea o trunca el resultado de acuerdo con las reglas del formato de punto flotante y el número de bits disponibles para la mantisa.

### Aplicacion en HW
- Operar en punto flotante requiere de tres operaciones: ajuste de exponente, cálculo matemático y normalización.
- En este sentido, la ejecución de operaciones de punto flotante en HW es muy costosa en términos de potencia, área y performance.
- Sólo tiene sentido en aplicaciones que involucren algoritmos donde mantener la exactitud intacta sea realmente necesario.
- En generaciones avanzadas de FPGAs o ASICs de muy alta densidad se incluye hardware para mapear algoritmos en punto flotante si así se requiere.
- En sistemas digitales de comunicaciones y procesamiento de señales, normalmente el diseñador comienza desarrollándolo usando aritmética de punto flotante de doble precisión en lenguajes como C++, Python o Matlab.  Luego de verificarlo funcionalmente y obtener la performance deseada, las variables y constantes de simulación se convierten a punto fijo para evaluar el desempeño frente a la cuantización y determinar los recursos necesarios para su implementación en hardware.


## Aritmética de punto fijo:
### Concepto
En la aritmética de punto fijo, los números se representan utilizando una cantidad fija de bits para la parte entera y la parte fraccionaria. El punto fijo se establece en una posición fija y no cambia durante las operaciones. Las operaciones se realizan de manera similar a las operaciones aritméticas convencionales. Esta aritmetica se utiliza en aplicaciones donde se conocen los rangos y las precisiones precisas de los valores involucrados. Es particularmente útil en situaciones donde se requiere una alta velocidad de cálculo y una implementación eficiente en términos de recursos de hardware.
### Formato
La representación en punto fijo de un número S(NB;NBF) consiste en la implementación de NB bits, de los cuales NBI representan la parte entera, NBF representan la parte fraccional y el bit MSB puede considerarse como el signo en casos que se opere con aritmética signada.
![[Pasted image 20230610125719.png|500]]
#### Representacion
- Se representa como: $$S(NB,NBF)$$
- Signado S o no signado U
- NB: Numero total de bit
- NBF: Numero de bits fraccionales
### Representacion no signada
#### Valor
- El valor de un numero binario x de NB-bits se representa por la expresion:
$$x=(\frac{1}{2^{NBF}})\sum_{n=0}^{NB-1}{2^nbn}$$


#### Notacion
![[Pasted image 20230610190920.png]]
- En este caso el valor de la izquierda nos dice cuantos valores a la derecha nos movemos de la coma y el valor de la derecha nos dice cuantos son validos.
	- Los que no son validos son iguales a 0
- En cada etapa del diseño tenemos que aclarar que representacion tenemos en esa etapa para evitar demasiados cables y desbordamiento, de esta manera tenemos que acondicionar nuestra señal antes de entrar a cada etapa

### Representacion signada
#### Valor
- El valor de un numero binario x de NB-bits se representa por la expresion:$$x=(\frac{1}{2^{NBF}})[-2^{NB-1}b(NB-1)+\sum_{n=0}^{NB-2}{2^nbn}]$$
#### Notacion
![[Pasted image 20230610191323.png]]
- En este caso el valor de la izquierda nos dice cuantos valores a la derecha nos movemos de la coma y el valor de la derecha nos dice cuantos son validos
	- Los que no son validos son igual al signo
	- Ademas nuestro primer bit del valor tambien tiene signo, por lo cual donde antes teniamos 2 bits que no eran validos, ahora tenemos 2 de signos + 1 de signo.
	- Si no tenemos ningun bit ““invalido” tendremos solo 1 de signo
- En cada etapa del diseño tenemos que aclarar que representacion tenemos en esa etapa para evitar demasiados cables y desbordamiento, de esta manera tenemos que acondicionar nuestra señal antes de entrar a cada etapa
### Conversion de Punto Flotante a Punto fijo
- Un número de punto flotante se convierte simplemente en formato de punto fijo de S(NB;NBF) tomando los NBI bits de la parte entera (saturando si fuese necesario) y luego los NBF bits de la parte fraccionaria truncando el resto de los bits con o sin redondeo.
- Desde el punto de vista de la implementación, un número en punto fijo se puede ver como un numero binario entero cuya posición decimal está implícita. Esto hace que el diseñador deba recordar el formato de cada número para poder realizar operaciones sobre el mismo de forma adecuada.
#### Observaciones punto flotante a punto fijo
- La complejidad se reduce utilizando un número pequeño de longitud de palabra en las variables del código, pero esto afecta negativamente al rendimiento numérico del algoritmo y añade ruido de cuantización.

### Operaciones
#### Suma con aritmética de punto fijo:
Para sumar dos números en formato de punto fijo, sigue los siguientes pasos:

> La cantidad de bit a la salida es igual a FraccionarioMAX+EnteroMAX+1
##### **Alinea los números:** 
Asegúrate de que los números tengan la misma longitud, es decir, el mismo número de bits para la parte entera y la parte fraccionaria.
- Los bits necesario en la parte fraccionaria se rellenan con 0
- Los bits necesarios en la parte entera se extension con signo
- Se agrega 1 bit adicional para el signo para evitar desbordamiento
![[Pasted image 20240131185854.png]]

##### **Realiza la suma binaria:**
Suma los valores binarios de los números, comenzando desde la posición más a la derecha (los bits menos significativos) hasta la posición más a la izquierda (los bits más significativos). Asegúrate de llevar cualquier acarreo a la siguiente posición.

##### **Controla el desbordamiento:**
Verifica si el resultado de la suma excede el rango representable en el formato de punto fijo. Si hay desbordamiento, puedes truncar o redondear el resultado según las reglas definidas para el formato de punto fijo.

##### **Ajusta la parte fraccionaria:**
Si los números sumados tienen una parte fraccionaria, asegúrate de que el resultado tenga la precisión adecuada. Puedes truncar o redondear los bits adicionales según sea necesario.

> La cantidad de bit a la salida es igual a la suma de los bits de entrada, la cantidad de fraccionarios es la suma de la cantidad de fraccionarios de entrada al igual que la parte entrea
#### Multiplicación con aritmética de punto fijo:
Para multiplicar dos números en formato de punto fijo, sigue los siguientes pasos:

##### **Multiplica los valores binarios:**
Realiza la multiplicación binaria de los números, teniendo en cuenta los bits correspondientes a la parte entera y la parte fraccionaria. Puedes utilizar el método convencional de multiplicación binaria.

##### **Ajusta el resultado:** 
Después de la multiplicación, el resultado puede tener una posición incorrecta del punto decimal. Ajusta la posición del punto decimal sumando o restando los bits necesarios para obtener la posición correcta según las reglas definidas.

##### **Controla el desbordamiento:** 
Verifica si el resultado de la multiplicación excede el rango representable en el formato de punto fijo. Si hay desbordamiento, aplica las reglas establecidas para controlar el desbordamiento.

##### **Ajusta la precisión:** 
Si los números multiplicados tienen una parte fraccionaria, asegúrate de que el resultado tenga la precisión adecuada. Puedes truncar o redondear los bits adicionales según sea necesario.

## Truncado y redondeo
Métodos utilizados para ajustar la precisión de un número en aritmética de punto fijo en la parte menos significativa. 
**Truncado:** Consiste en eliminar los bits menos significativos (la parte fraccionaria) del número, manteniendo solo los bits deseados según la precisión requerida.
- El truncado puede introducir un error en los resultados, ya que se descartan los bits menos significativos. 
	- Se sebe considerar cuidadosamente la precisión requerida en tu aplicación y los efectos del truncado en la precisión y la exactitud de los cálculos.
**Redondeo:**  En lugar de simplemente truncar los bits menos significativos, se toma en cuenta el bit siguiente (el bit de redondeo) para determinar si se debe aumentar o mantener el último bit significativo.
- El redondeo también puede introducir un error en los resultados, ya que se realiza una aproximación. 
- Es importante considerar la precisión requerida y el método de redondeo apropiado para tu aplicación específica.

> El truncado y redondeo se aplica sobre la parte menos significativa del numero en punto fijo a resolver(solo la parte fraccionaria)

#### Como hago el redondeo?
- Para el redondeo le sumo o resto 1 al valor mas significativo a truncar, y luego trunco
![[Pasted image 20240131191118.png]]
- Si le sumo o le resto siempre 1, es redondeo asimetrico
- Si sumo o resto dependiendo del signo, el redondeo es simetrico
- Se realiza este redondeo simetrico es influyendo para sistemas de deteccion del valor de bit como en telecomunicaciones

#### truncado o redondeo?
- El truncado o redonde asimetrico te hace en total en tu sistema tener un error con forma de una gaussiana pero sin campana en 0
- Pero si aplicamos redondeo simetrico, tenemos error con forma gaussiana pero con capana en 0

## Overflow y Saturacion
El overflow o saturacion son en la parte mas significativa.

El **desbordamiento** ocurre cuando el resultado de una operación aritmética excede los límites del rango representable en el formato de punto fijo. En aritmética de punto fijo con signo, el rango está determinado por el número de bits utilizados y su interpretación (complemento a dos).
En caso de desbordamiento positivo, el resultado de la operación es mayor al valor máximo representable en el formato de punto fijo.
En caso de desbordamiento negativo, el resultado de la operación es menor al valor mínimo representable en el formato de punto fijo. .


La **saturación** es una técnica utilizada para evitar el desbordamiento en la aritmética de punto fijo. En lugar de permitir que el resultado exceda los límites del rango representable, se limita el valor resultante al valor máximo o mínimo representable más cercano.
La saturación es útil cuando se desea mantener el resultado dentro del rango representable, evitando así desbordamientos. Sin embargo, debes tener en cuenta que la saturación puede introducir un error sistemático, ya que los valores resultantes pueden diferir de los cálculos precisos.


![[Pasted image 20240131193002.png]]

### Ejemplos en suma
![[Pasted image 20240131193016.png]]

### Problemas en la multiplicacion
![[Pasted image 20240131193156.png]]
![[Pasted image 20240131193205.png]]

![[Pasted image 20240131193214.png]]
![[Pasted image 20240131193221.png]]