---
cards-deck: Profesional::Universidad::4to año::Procesamiento digital de seniales
---


## Disenio de filtros #tarjeta-anki 
El diseño de filtros digitales implica varias etapas, y aquí exploramos estas fases y consideraciones clave:
### Fases del diseño
#### 1. Especificación de Propiedades Deseadas:
- **Primera Etapa:** La especificación de las propiedades deseadas del sistema es la fase inicial. Esto implica definir las características que se buscan en el filtro, como la respuesta en frecuencia, la atenuación, la frecuencia de corte, etc.
#### 2. Aproximación de Especificaciones:
- **Segunda Etapa:** La aproximación de las especificaciones se realiza utilizando un sistema causal de tiempo discreto. Aquí, se busca determinar la función de un sistema lineal de tiempo discreto cuya respuesta de frecuencia se ajuste a las tolerancias prescritas. Este proceso implica técnicas específicas para filtros IIR (Respuesta Infinita al Impulso) y FIR (Respuesta Finita al Impulso).
#### 3. Realización del Sistema:
- **Tercera Etapa:** La realización del sistema es la implementación práctica del filtro diseñado. En entornos prácticos, los filtros deseados se implementan comúnmente con cálculos digitales y se utilizan para filtrar señales que provienen de un proceso de muestreo y conversión analógico a digital.
^1705841820215


#### Consideraciones Clave:
- **Naturaleza Digital:** Aunque se hace referencia comúnmente a los filtros de tiempo discreto como filtros digitales, las técnicas subyacentes a menudo se relacionan con la naturaleza de tiempo discreto de las señales y sistemas.

- **Transformación de Frecuencia:** Se utiliza la transformación de frecuencia para obtener las especificaciones del filtro de tiempo continuo a partir de las especificaciones en \(H(e^{j\omega})\).
^1705841820221

- **Aliasing:** La transformación de tiempo continuo a tiempo discreto puede introducir aliasing, que se mitiga sobrediseñando el filtro continuo, especialmente en la banda de parada.

- **Invariancia de Impulso:** En el procedimiento de diseño de invariancia de impulso, las especificaciones del filtro de tiempo discreto se transforman primero en especificaciones de filtro de tiempo continuo.


### Metodos de diseño
En ambos casos los metodos se basan en:
1. Diseniar filtro prototipo
	- Que cumpla con las espeficifaciones de amplitud
2. Transofrmazion espectral
	- Obtener la FT del filtro deseado
3. Obtener filtro deseado
- **Metodo directo**
	- Se parte de digital
	- Aplico transformaciones necesarias y se obtiene el filtro digital deseado
$$Hlp(z^{-1})-->z^{-1}-->g(z^{-1})-->H(z^{-1})$$
- **Metodo indirecto**
	- Se parte de analogico
	- Se busca el filtro analogico pasa bajo prototipo con H(s)
	- Aplicando transformaciones obtengo el filtro digital deseado
$$Hlp(s)-->S-->f(z^{-1})-->H(z^{-1})$$
**En clase usaremos el metodo indirecto**





## Diseño de filtros figitales en el dominio de la frecuencia(Causalidad y Estabilidad) #tarjeta-anki 
La causalidad, sinónimo de viabilidad, tiene importantes implicaciones en el comportamiento frecuencial del filtro.
El diseño de filtros digitales causales consiste en determinar sus coeficientes utilizando especificaciones normalmente formuladas en el dominio de la frecuencia, expresadas en términos de amplitud y fase de la respuesta del filtro deseada.
Sin embargo, esta actitud no garantiza que una determinada respuesta de frecuencia produzca una respuesta de impulso causal.
Aunque no existe una solución general al problema, se pueden identificar las condiciones necesarias o al menos suficientes imponiendo restricciones a la respuesta de frecuencia.
### Causalidad
- **Definición:** Un sistema se considera causal si no es "predictivo", es decir, su respuesta no depende de eventos futuros.
- **Relación con la Transformada de Fourier:** Paley y Wiener demostraron que para una secuencia $h(n)$ cero para $n < 0$ y con energía finita ($h(n)^2 < +\infty$), la transformada de Fourier verifica: $\int_{-\infty}^{+\infty} |h(n)H(e^{j\omega})|^2 d\omega < +\infty$. Esto implica que un filtro causal no puede tener su respuesta de frecuencia cero en una banda finita.
- **Relación entre Parte Real e Imaginaria:** La causalidad también impone una relación fuerte entre la parte real $H_R(e^{j\omega})$ y la parte imaginaria $H_I(e^{j\omega})$ de $H(e^{j\omega})$. La secuencia $h(n)$ se descompone en dos secuencias, una par $h_p(n)$ y otra impar $h_a(n)$, lo que lleva a una interdependencia entre $H_R(e^{j\omega})$ y $H_I(e^{j\omega})$.
### Estabilidad
- **Definición:** Un sistema es estable si, cuando se lo estimula con una entrada "limitada", responde con una salida "limitada".
- **Condición Necesaria y Suficiente para Estabilidad:** Paley y Wiener establecieron que una condición necesaria y suficiente para la estabilidad es que la secuencia $h(n)$ sea cero para $n < 0$ y tenga energía finita ($h(n)^2 < +\infty$).
- **Implicaciones en el Diseño de Filtros Digitales:** La causalidad y estabilidad tienen implicaciones cruciales para el diseño de filtros digitales, como:
  - La respuesta en frecuencia $H(e^{j\omega})$ no puede ser cero excepto en un conjunto finito de puntos.
  - La amplitud $|H(e^{j\omega})|$ no puede ser constante en una banda finita, lo que puede dar lugar a oscilaciones en bandas de paso y prohibidas debido al fenómeno de Gibbs.
  - La parte real $H_R(e^{j\omega})$ y la parte imaginaria $H_I(e^{j\omega})$ son interdependientes, lo que implica que el módulo y la fase de $H(e^{j\omega})$ no pueden seleccionarse arbitrariamente.
### Estabilidad en Filtros Digitales
#### Definición de Estabilidad (BIBO):
- **Definición:** Un sistema es estable en el sentido de entrada limitada, salida limitada (BIBO) si y solo si cada secuencia de entrada limitada produce una secuencia de salida limitada. Una secuencia de entrada $x[n]$ está acotada si existe un valor finito positivo fijo $B$, tal que $|x[n]| \leq B$ para todos $n$.
#### Diseño de Filtros Digitales en el Dominio de la Frecuencia:
- **Preservación de la Estabilidad:** Para preservar la propiedad de estabilidad, los filtros prácticos no pueden presentar discontinuidades en la respuesta en frecuencia. La condición de causalidad impone que la respuesta no desaparezca de manera idéntica en un intervalo de frecuencia diferente de cero. Por lo tanto, las especificaciones se dan en términos de dos frecuencias distintas para cada transición entre la banda de paso y la banda oscura.
#### Propiedades de la Estabilidad:
- **Condición de Estabilidad:** La estabilidad requiere que, para cada entrada acotada, exista un valor finito positivo fijo $B_y$ tal que $|y[n]| \leq B_y$ para todos $n$.
- **Importancia de la Estabilidad:** Las propiedades definidas (estabilidad y otras) son propiedades del sistema, no de las entradas al sistema. La existencia de la propiedad para algunas entradas no garantiza que el sistema tenga la propiedad. Un sistema inestable puede tener algunas entradas acotadas con salidas acotadas, pero para que el sistema sea estable, la salida debe estar acotada para todas las entradas acotadas.
^1705841820224



## Filtros Digitales Base
### Especificiaciones de filtros
- Ap: atenuacion maxima en la zona de paso
- Ab: atenuacion minima en la zona de bloqueo
- fp: frecuencia limite de la zona de paso
- fb: frecuencia limite de la zona de bloqueo
![[Pasted image 20221121110656.png]]
#### Calculo de la atenuacion
$$A=10log(\frac{1}{|H(w)^2|})=-20log(|H(w)|)$$
**Si estamos trabajando con Butterworth:**$$A=10log(1+(\frac{w}{wc})^{2.N})$$


### Tipo de filtro por su respuesta en el tiempo

![[Pasted image 20231112224437.png]]
#### IIR
Filtros de respuesta infinita al impulso, se implementan mediante *Recursibidad*
- Estos filtros cuando le aplicamos un impulso, tiene respuestas hasta el infinito(osea, infinito valores)
- Se considera que tenemos IIR cuando tenemos denominador, ya que este trabajaria como realimentacion
**Funcion de transferencia e implementacion:**
![[Pasted image 20221119120913.png]]
#### FIR
Filtro de respuesta finita al impulso, se implementan mediante *convoluzione*
- Se considera que tenemos FIR cuando tenemos el numerador, ya que esto seria como un sistema de lazo abierto
![[Pasted image 20221119120950.png]]
#### FIR vs IIR
![[Pasted image 20221119121112.png]]



¿Por qué utilizar filtros FIR en algunas aplicaciones y filtros IIR en otras? Cada tipo tiene sus ventajas y desventajas.
- Es fácil diseñar un filtro FIR con una respuesta de fase lineal. 
	- Se piensa que esto es mejor para las señales de audio porque evita la distorsión de fase, una degradación en la calidad del sonido causada por retrasos dependientes de la frecuencia que tienden a emborronar los transitorios y a desdibujar las imágenes estéreo.
- Los filtros FIR no tienen retroalimentación, siempre son estables y nunca oscilan. 
- Una desventaja de los filtros FIR es que requieren más operaciones aritméticas y memoria que un filtro IIR con características de frecuencia similares. (Algunos filtros FIR tienen miles de etapas de retardo, como se aclara más adelante en la sección sobre convolución.) 
- Un filtro FIR determinado puede ser más costoso en términos de hardware que un filtro IIR que tiene un efecto similar.
- Los filtros IIR pueden producir cortes y realces nítidos y de forma exponencial, la retroalimentación del filtro de la salida pasada elimina muchos de los pasos aritméticos y accesos a la memoria que serían necesarios para lograr el mismo efecto en un filtro FIR.
- Los filtros IIR sufren, sin embargo, distorsión de fase y zumbidos (Preis 1982). El timbre significa que los transitorios tienden a excitar el filtro, provocando que oscile (suene) durante algún tiempo después de que el transitorio haya pasado por el sistema. 
- Los filtros IIR difuminan los transitorios con el tiempo, difuminando las altas frecuencias y dando una calidad dura. Además, debido a la naturaleza recursiva del cálculo, los filtros IIR son más sensibles a la acumulación de errores de redondeo en la aritmética del filtro que los filtros FIR correspondientes. 



## Metodo directo
### Transformaciones espectales digitales
Si estamos diseniando un filtro por metodo directo, primero diseniaremos un pasa bajo prototipo y de ahi pasaremos al que requerimos, esto lo hacemos con la funcion unitaria $g(z^{-1})$, esta funcion modifica el eje de w sin modificar la amplitud, lo que haremos es remplazar en nuestra funcion transferencia del filtro prototipo $Z^{-1}=g(Z^{-1})$
#### Pasa bajos a pasa bajos
$$g(z^{-1})=\frac{z^{-1}-a}{1-a.z^{-1}}$$
- $|a|<1$
- $a=-\frac{cos(\frac{wo-wc}{w}.T)}{cos(\frac{wo+wc}{2}T)}$
- wo: frecuencia de corte del filtro digital pasa bajos prototipo
- wc:frecuencia de corte del nuevo filtro digital pasa bajos
#### Pasa bajos a pasa altos
$$g(z^{-1})=-\frac{z^{-1}+a}{1+a.z^{-1}}$$
- $|a|<1$
- $a=-\frac{seno(\frac{wo-wc}{w}.T)}{seno(\frac{wo+wc}{2}T)}$
- wo: frecuencia de corte del filtro digital pasa bajos prototipo
- wc:frecuencia de corte del nuevo filtro digital pasa bajos
#### Pasa bajos a pasa banda
![[Pasted image 20221121194931.png|500]]
#### Pasa bajos a bloqueo banda
![[Pasted image 20221121195000.png|500]]

#### Observaciones
- En la imprementacion digital los elementos estan aislados fisicamente
	- No hay problema de aislacion si de redondeo y cuantizacion


**Referencia**
- [[Matlab]]
-  [[2. Transformada Z]]


























