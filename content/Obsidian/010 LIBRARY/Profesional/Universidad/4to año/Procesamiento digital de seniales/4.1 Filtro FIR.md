---
cards-deck: Profesional::Universidad::4to año::Procesamiento digital de seniales
---

# Bases
Se implementan mediante bloques de suma, multiplicacion por una constante y retardos. Para esto no se realimenta el circuito y su salida solo depende de la entrada.
![[Pasted image 20231112224410.png]]
- Estos filtros se pueden implementar con las estructuras
	- Directa 1(En serie)
	- Directa 2(En paralelo)
	- Cascada
## Descripcion general de un filtro FIR
- Ecuacion de diferencias general
$$yn=\sum_{k=0}^{M-1}b_kx(n-k)$$
- Funcion de transformacion general
$$H(z)=\sum_{k=0}^{M-1}b_k.z^{-k}$$
- Respeusta general
$b_n$ si 0< n< M-1
0 en otros casos

## Filtros FIR simetricos y Antisimetricos
Nuestro tratamiento esta centrado en los filtros FIR de **fase lineal**
Un filtro FIR se describe con una ecuacion de diferencias donde solo depende de la entrada del mismo y no de salidas anteriores.
Un filtro FIR tiene fase lineal si su respuesta al impulso unidad sastiface la condicion $$h(n)=\pm h(M-1-n),n=0,1,...,M-1$$
Si aplicamos esta condicion a la ecuacion de difererencia de un filtro FIR obtenemos que las raices del polinomio $H(z)$ son identicas a las raices del polinomio $H(z^{-1})$, esto tambien nos sirve para poder reducir el numero de operaciones en un filtro



# Diseño
## Disenio de filtros FIR de fase lineal utilizando ventanas #tarjeta-anki 
En este metodo, apartir de la respuesta en frecuencia deseada Hd(w) determinamos la correpondiente respuesta al impulso unidad deseada hd(n), cuando obtenemos hd(n) nos damos cuenta que esta es infinita, ya que viene de la definicion de transformada de fourier, por lo que, para limitar esta respues y tener una finita, aplicamos una *ventana*, de ahi viene el nombre del metodo, con esta ventana truncamos la funcion hd(n) a una longitud M-1, esto lo hacemos multiplicando la ventana por hd(n) en el dominio del tiempo. 
Sabemos que multiplicar en el tiempo es equivalente a convolucionar en la frecuencia, por lo que la nueva respuesta en el dominio de la frecuencia seria la convolucion de la transformada de ventana con la transformada deseada.
Una ventana ideal, rectangular, generaria efectos no deseados debido al rizado generado y los grandes lobulos secundarios que generaria, por lo que se plantean otros tipos de ventana. En esta seccion solo analizaremos la ventada rectangular, Hamming y Kaiser
![[Pasted image 20221121205142.png|500]]
### Tipos de ventanas
#### Ventana rectangular
**Secuencia en el tiempo**
$$h(n)=1,0<n<M-1$$
**Anchura aproximada de la region de transicion del lobulo principal**
$$\frac{4.\pi}{M}$$
**Pico del lobulo secundario**
$$-13dB$$
#### Ventana Hamming
**Secuencia en el tiempo**
$$0,54-0,46.cos(\frac{2.\pi.n}{M-1})$$
**Anchura aproximada de la region de transicion del lobulo principal**
$$\frac{8.\pi}{M}$$
**Pico del lobulo secundario**
$$-31dB$$
#### Ventana Kaiser
**Secuencia en el tiempo**
![[Pasted image 20221121210158.png]]
- Si $\alpha$ aumenta
	- Se alarga el lobulo principal
	- Se achica los lobulos laterales
- Si M aumenta
	- Se estrecha el lobulo principal
	- No varia la altura de los lobulos laterales
### Diseño
#### Criterios
- **Elección de Ventana y Tamaño \(N\):**
   - Se debe elegir el tipo de ventana y el número \(N\) de muestras considerando:
     - La amplitud máxima de las oscilaciones en la banda de paso y de atenuación depende del tipo de ventana, pero no de \(N\).
     - La amplitud de la banda de transición es inversamente proporcional a \(N\), con un coeficiente dependiente del tipo de ventana.
- **Criterio de Dimensionamiento:**
   - Consiste en determinar el número de muestras \(M\) de manera que el error cuadrático medio efectivo \(ε^2\) debido a la ventana sea menor que un error cuadrático medio mínimo establecido.
#### Procedimiento
1. **Definición de Arrays:**
   - Definir un array de magnitudes (magnitude array) y otro de fases (phase array), ambos de la misma longitud.
2. **Conversión a Coordenadas Rectangulares:**
   - Convertir la información anterior en coordenadas rectangulares (parte real y parte imaginaria).
3. **Aplicación de la FFT Inversa:**
   - Aplicar la FFT inversa para pasar al dominio del tiempo.
4. **Ajustes en el Dominio del Tiempo:**
   - Shiftar, truncar y aplicar una ventana al señal obtenida para definir la respuesta al impulso del filtro.
5. **Retorno al Dominio de la Frecuencia:**
   - Volver al dominio de la frecuencia (zero-padding y FFT) para verificar la correspondencia entre la respuesta obtenida y la deseada.
6. **Ajuste de Longitud del Kernel:**
   - Aumentar la longitud del kernel mejora la correspondencia entre la respuesta en frecuencia obtenida y la deseada.
^1705842565511


### Ventajas y desventajas del metodo
- Ventaja
	- Simple
- Desventaja
	- La funcion analitica debe ser integrable
	- Desviaciones maximas iguales en banda de paso y atenuacion
	- Oscilacion de la desviacion
	- La ventana rectangular puede llevar a comportamientos adversos en discontinuidades.
	- No permite control individual sobre los errores en diferentes bandas



## Campionamiento en Frecuencia #tarjeta-anki 
- Se selecciona un número adecuado de muestras en frecuencia y se calcula h(n) para que la correspondiente H(ω) pase por las muestras deseadas.
- La solución puede lograrse mediante:
  - Uso de la IDFT (muestras equiespaciadas).
  - Solución de un sistema lineal.
  - Ecuaciones directas.
- Se eligen N muestras equiespaciadas en el círculo unitario, con simetría conjugada y el primer punto en 1.
- Se aplica la IDFT a estas muestras para obtener h(n).
- La respuesta en frecuencia de la secuencia obtenida estará vinculada a pasar por las muestras iniciales.
![[Pasted image 20231113090532.png]]
### **Campionamento de la Mascara Ideal en Frecuencia:**
- Se define la máscara ideal en frecuencia.
- Se realiza un muestreo de la misma en N puntos equidistantes.
- Se aplica la IDFT a las muestras obtenidas para obtener la respuesta impulsiva del filtro.
- Este procedimiento garantiza que la respuesta en frecuencia del filtro pase EXACTAMENTE por los puntos de muestreo de la máscara ideal.
### **Consideraciones sobre la Selección de Muestras:**
- Los puntos de muestra deben ser iguales a los puntos independientes de la respuesta impulsiva "h(n)".
- Dependen de la simetría y paridad:
  - Simétrico impar: (N+1)/2.
  - Simétrico par: N/2.
  - Antisimétrico impar: (N-1)/2 (el punto central es nulo).
  - Antisimétrico par: N/2.
- No deben conducir a una matriz singular y deben respetar otras restricciones.
**Consideraciones Adicionales:**
- Los puntos de muestra comúnmente se eligen equiespaciados en el círculo unitario.
- Se puede utilizar la IDFT para calcular "h(n)" cuando las muestras se toman equiespaciadas en el círculo unitario.
- A priori, esto no garantiza la linealidad de fase, y hay grados de libertad explotables, como la fase y el signo de las muestras.
**Ventajas y Desventajas:**
- Ventajas:
  - Aplicable a cualquier respuesta en frecuencia.
  - Disponibilidad de programas de diseño.
- Desventajas:
  - Control difícil de las desviaciones.
  - Oscilación de la desviación no constante.
  - Mayor N para respuestas en frecuencia comparables.
^1705842565514





## Criterio de Chebyschev

El criterio de Chebychev busca minimizar el error en las bandas de paso y detención mediante la aproximación de Chebychev. Se utiliza un algoritmo como Parks–McClellan para resolver este problema. Aquí se detalla el proceso:

1. **Estimación de N:**
   - Para filtros de paso bajo, se estima N usando una relación empírica basada en el ancho de la banda de transición y las desviaciones.
![[Pasted image 20231113091408.png]]


2. **Algoritmo de Parks–McClellan:**
   - Iterativo y diseñado para filtros FIR Chebyshev óptimos.
   - Minimiza el error en bandas de paso y detención mediante la aproximación de Chebychev.
   - Es una variante del algoritmo Remez y se ha convertido en estándar para el diseño de filtros FIR.

3. **Resultados Óptimos:**
   - El algoritmo proporciona los coeficientes óptimos para el filtro Chebyshev deseado.
   - Logra un equilibrio entre las desviaciones en bandas de paso y detención.

### Ventajas y Desventajas:

**Ventajas:**
- Criterio óptimo para minimizar errores.
- Menor número de coeficientes (N) para respuestas en frecuencia comparables.
- Disponibilidad de programas de diseño.

**Desventajas:**
- Puede ser relativamente inflexible en cuanto a la respuesta en frecuencia deseada.
- El proceso de diseño puede ser más costoso en términos de tiempo de cálculo.





